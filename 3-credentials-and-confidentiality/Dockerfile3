TO-DO: layer optimization - before
