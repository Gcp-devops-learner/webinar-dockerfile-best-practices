TO-DO: layer optimization - after
